syntax = "proto3";

package auth;

option go_package = "tuzow.sso.v1.ssov1";


service auth{
	rpc Register (RegisterRequest) returns (RegisterResponse);
	rpc Login(LoginRequest)returns(LoginResponse);
	rpc IsAdmin(IsAdminRequest)returns(IsAdminResponse);
}

message IsAdminRequest{
	string email = 1;
	int32 password = 2;
}

message IsAdminResponse{
	int64 user_id = 1;
}

message LoginRequest{
	string email = 1; //обычный мейл
	string password = 2; // обычный пороль
	int32 app_id = 3; // ID приложения к которому хочет залогинится пользователь.
}

message LoginResponse{
	string token = 1; //токен пользователья который зарегестрируется в приложении
}

message RegisterRequest{
	string email = 1; // мейл юзера который болучает протофайл
	string password = 2; // пороль который получает протофайл
}
message RegisterResponse{
	int32 user_id = 1; //протофайл вернет нам ID юзера из БД в списке регистрированных.
}
service permision{
	rpc Permision (PermisionRequest) returns (PermisionResponse);
}

message PermisionRequest{
	string  PermisionRequest = 1; // запрос на сервер при котором мы узнаем админ ли пользователь или нет:
	bool Permision = 2; // проверка всех прав пользователя true = админ false = бомжара.
}

message PermisionResponse{
	string user_id = 1;
	bool user_permision = 2;

}
service user_info{
	rpc user_info(password) returns (email);
	rpc user_permision(user_id) returns (BoolPermision);
}

message BoolPermision{
	bool Permision = 1;
	string Bool = 2;
}

message password{
	int32 password = 1;
}

message email{
	string email = 1;
}

message user_id{
	int64 user_id = 1;
	string user_info = 2;
}
